(()=>{"use strict";const e=async function(){const e=await fetch("api_key.txt");return`&appid=${await e.text()}`}(),t=async function(){try{console.log("loading");const e=await fetch("city.list.json",{mode:"cors"});return await e.json()}catch(e){console.log(e)}}();const n={clear:"01d",clouds:"02d","scattered clouds":"03d","broken clouds":"04d","shower rain":"09d",rain:"10d",thunderstorm:"11d",snow:"13d",mist:"50d"};const a=document.querySelector("#submit-button"),c=document.querySelector("#city-name"),o=document.querySelector("#display"),d=document.querySelector("form");function r(){for(;o.firstChild;)o.firstChild.remove()}async function i(t){r();try{const a=await async function(t){try{const n=`https://api.openweathermap.org/data/2.5/onecall?lat=${t.coord.lat}&lon=${t.coord.lon}&exclude=minutely,hourly&units=imperial${await e}`,a=await fetch(n,{mode:"cors"});return(await a.json()).daily.map((e=>{return{weatherDescription:(t=e).weather[0].main,clouds:t.clouds,humidity:t.humidity,rain:t.rain,maxTemp:Math.round(parseFloat(t.temp.max)),minTemp:Math.round(parseFloat(t.temp.min))};var t}))}catch(e){console.log(e)}}(t),c=document.createElement("div");c.classList.add("flex-container"),a.forEach(((e,t)=>{const a=function(e,t){const a=document.createElement("div");a.classList.add("weather-data-display");const c=document.createElement("div");c.classList.add("weekday"),c.textContent=function(e){const t=(new Date).getDay();if(0===e)return"Today";switch((t+e)%7){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday"}}(t),a.appendChild(c);const o=document.createElement("img");o.src=function(e){if(n.hasOwnProperty(e))return`http://openweathermap.org/img/wn/${n[e]}@2x.png`;console.log(`No icon found for ${e}`)}(e.weatherDescription.toLowerCase()),a.appendChild(o);const d=document.createElement("div");d.textContent=e.weatherDescription,a.appendChild(d);const r=document.createElement("div");r.classList.add("temperature-container");const i=document.createElement("div");i.textContent=`Hi: ${e.maxTemp}Â°`,i.classList.add("temperature"),r.appendChild(i);const s=document.createElement("div");return s.textContent=`Lo: ${e.minTemp}Â°`,s.classList.add("temperature"),r.appendChild(s),a.appendChild(r),a}(e,t);c.appendChild(a)})),o.appendChild(c)}catch(e){console.log(e)}}a.addEventListener("click",(()=>{c.checkValidity()&&async function(e){r();const n=await async function(e){const n=e.toLowerCase().trim();try{return(await t).filter((e=>e.name.toLowerCase()===n))}catch(e){console.log(e)}}(e);if(0===n.length)!function(e){const t=document.createElement("div");t.classList.add("error-message"),t.textContent="No cities found!",o.appendChild(t)}();else if(1===n.length)i(n[0]);else{const e=document.createElement("div");e.classList.add("city-message"),e.textContent=`${n.length} cities found! Select one:`,o.appendChild(e);const t=document.createElement("div");t.classList.add("flex-container"),o.appendChild(t),n.forEach((e=>{const n=function(e){const t=document.createElement("div");t.classList.add("city-data-display");const n=document.createElement("div");if(n.textContent=e.name,t.appendChild(n),e.hasOwnProperty("state")){const n=document.createElement("div");n.textContent=e.state,t.appendChild(n)}if(e.hasOwnProperty("country")){const n=document.createElement("div");n.textContent=e.country,t.appendChild(n)}return t}(e);t.appendChild(n),n.addEventListener("click",(()=>{i(e)}))}))}}(c.value)})),d.addEventListener("keydown",(e=>{"Enter"===e.key&&a.click()}))})();